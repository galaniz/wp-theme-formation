!function(){"use strict";const e=(e,t,n=!0)=>{if(!e||!t)return;let o=e.className.split(" "),r=n;return(t=t.split(" ")).forEach((e=>{let t=o.indexOf(e);if(n){if(-1===t)return void(r=!1)}else if(-1!==t)return void(r=!0)})),r},t=(t,n,o=10)=>{if(!t||!n)return;let r=t.parentElement,a=0;for(;!1===e(r,n);)if(r=r.parentElement,a++,a===o){r=!1;break}return r},n=e=>new Promise(((t,n)=>{let o=new XMLHttpRequest;o.open(e.method||"GET",e.url),e.headers&&Object.keys(e.headers).forEach((t=>{o.setRequestHeader(t,e.headers[t])})),o.onload=()=>{if(o.status>=200&&o.status<300)try{t(o.responseText)}catch(e){n("Oops something went wrong.")}else n(o)},o.onerror=()=>n(o),o.send(e.body||null)}));var o=void 0;document.addEventListener("DOMContentLoaded",(function(){var r=window.namespace;if(window.hasOwnProperty(r)){var a=window[r];if(a.hasOwnProperty("geonames_un")&&a.geonames_un){var l="https://secure.geonames.org/",i="&username=".concat(a.geonames_un),u=function(e,t){e.disabled=t,e.innerHTML='<option value="">— Select —</option>'},c=function(t,n){var o=t.nextElementSibling;n?e(o,"o-error")||t.insertAdjacentHTML("afterend",'<p class="o-error">Sorry, looks like the country you entered can\'t be found.</p>'):o&&o.parentNode.removeChild(o)},s=function(e){var n=t(e,"o-field");return{countryCode:n.nextElementSibling.querySelector("input"),countryId:n.nextElementSibling.nextElementSibling.querySelector("input"),stateSelect:n.nextElementSibling.nextElementSibling.nextElementSibling.querySelector("select"),state:n.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.querySelector("input"),stateName:n.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.querySelector("input")}},d=function(e){n({method:"POST",url:l+"childrenJSON?geonameId="+e.countryId+i}).then((function(t){var n=!0;(t=JSON.parse(t)).hasOwnProperty("geonames")&&t.geonames.length&&(n=!1,u(e.stateSelect,!1),function(e){var t='<option value="">— Select —</option>',n="",o=e.selected||"";e.admin2.forEach((function(e,r){0==r&&(n=e.countryCode);var a=e.name,l=a,i="";e.hasOwnProperty("adminCodes1")&&e.adminCodes1.hasOwnProperty("ISO3166_2")&&(l=e.adminCodes1.ISO3166_2,o==l&&(i=" selected")),t+='<option value="'+l+'"'+i+">"+a+"</option>"})),e.codeInput.value=n,e.stateSelect.innerHTML=t}({codeInput:e.codeInput,stateSelect:e.stateSelect,admin2:t.geonames,selected:e.selected||""})),n&&(u(e.stateSelect,!0),c(e.countryInput,!0))})).catch((function(t){u(e.stateSelect,!0),c(e.countryInput,!0)}))},m=function(e,t,o){if(t){t=encodeURIComponent(t);var r=s(e),a=r.countryCode,m=r.countryId,S=r.stateSelect,p=r.state;u(S,!1),c(e,!1);var g=l+"searchJSON?name_equals="+t+"&adminCode1=00&maxRows=1"+i;o||(g=l+"countryInfoJSON?country="+t+"&maxRows=1"+i),n({method:"POST",url:g}).then((function(t){var n=!0;if(t=JSON.parse(t),console.log(t),t.hasOwnProperty("geonames")&&t.geonames.length){n=!1;var r=o?t.geonames[0].countryId:t.geonames[0].geonameId;m.value=r,o||(e.value=t.geonames[0].countryName),d({countryId:r,countryInput:e,codeInput:a,stateSelect:S,selected:p.value})}n&&(u(S,!0),c(e,!0))})).catch((function(t){u(S,!0),c(e,!0)}))}};window.getAdmin1=function(e){var t=e.currentTarget,n=t.value.trim();m(t,n,!0)},window.setAdmin3Input=function(e){var n=e.currentTarget,o=n.options[n.selectedIndex],r=t(n,"o-field");if(o&&r){var a=r.nextElementSibling;a.querySelector("input").value=o.value,a.nextElementSibling.querySelector("input").value=o.textContent}};var S=[].slice.call(document.querySelectorAll(".js-admin1"));S.length&&S.forEach((function(e){var t=s(e),n=t.countryCode,r=t.countryId,a=t.stateSelect,l=t.state;r.value?d({countryId:r.value,countryInput:o,codeInput:n,stateSelect:a,selected:l.value}):m(o,n.value,!1)}))}}}))}();